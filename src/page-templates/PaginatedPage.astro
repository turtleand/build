---
import BlogLayout from '../layouts/BlogLayout.astro';
import PostCard from '../components/PostCard.astro';
import type { PostEntry } from '../utils/blog';
import type { Locale } from '../utils/i18n';
import { getDictionary, otherLocale } from '../utils/i18n';

interface Props {
	locale: Locale;
	basePath?: string;
	pagePosts: PostEntry[];
	currentPage: number;
	totalPages: number;
}

const { locale, basePath = '', pagePosts, currentPage, totalPages } = Astro.props as Props;
const dictionary = getDictionary(locale);
const altLocale = otherLocale(locale);
const alternateHref = altLocale === 'es' ? '/es' : '/';
const alternateLabel = dictionary.navigation.locales[altLocale].aria;

const prevHref = currentPage <= 2 ? `${basePath}/` : `${basePath}/page/${currentPage - 1}`;
const nextHref = `${basePath}/page/${currentPage + 1}`;
---

<BlogLayout
	title={`${dictionary.pagination.label} ${currentPage} | ${dictionary.site.title}`}
	description={dictionary.site.description}
	locale={locale}
	dictionary={dictionary}
	basePath={basePath}
	alternateHref={alternateHref}
	alternateLabel={alternateLabel}
>
	<section class="section">
		<div class="section-header">
			<h1>{dictionary.sections.allTitle}</h1>
			<p>{dictionary.pagination.label} {currentPage} / {totalPages}</p>
		</div>
		<div class="grid">
			{pagePosts.map((post) => (
				<PostCard post={post} locale={locale} basePath={basePath} dictionary={dictionary} />
			))}
		</div>
		<nav class="pagination" aria-label="Pagination">
			{currentPage > 1 ? (
				<a class="pill subtle" href={prevHref}>{dictionary.pagination.previous}</a>
			) : (
				<span class="pill subtle disabled">{dictionary.pagination.previous}</span>
			)}
			<span class="pagination-label">{dictionary.pagination.label} {currentPage} / {totalPages}</span>
			{currentPage < totalPages ? (
				<a class="pill subtle" href={nextHref}>{dictionary.pagination.next}</a>
			) : (
				<span class="pill subtle disabled">{dictionary.pagination.next}</span>
			)}
		</nav>
	</section>
</BlogLayout>

<style>
.section {
	margin-top: 1rem;
}

.section-header h1 {
	margin: 0;
	font-family: var(--font-heading);
}

.section-header p {
	margin: 0.3rem 0 0;
	color: var(--text-muted);
}

.grid {
	display: grid;
	grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
	grid-auto-rows: 1fr;
	gap: 1.4rem;
	margin-top: 1.35rem;
	align-items: stretch;
}

.pagination {
	margin-top: 2.25rem;
	display: flex;
	gap: 0.75rem;
	align-items: center;
	flex-wrap: wrap;
}

.pill.disabled {
	opacity: 0.6;
	pointer-events: none;
}

.pagination-label {
	color: var(--text-muted);
}
</style>
